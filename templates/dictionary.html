<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Dictionary Page</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/dictionary.css' %}">
</head>
<body>
    <main>
        <div class="page-heading">
            <div class="title-block">
                <h1>ASL Dictionary</h1>
                <p>Look up words, letters, and numbers in the same universe as your learning path.</p>
            </div>
            <a class="pill" href="#dictionary" aria-label="Jump to dictionary content">Explore</a>
        </div>

        <div id="dictionary" class="dictionary-shell">
            <h1 class="page-title">ASL Dictionary</h1>
            <div class="mode-toggle">
                <a data-mode-toggle href="?mode=words" class="pill-link {% if mode != 'letters' %}is-active{% endif %}">Words</a>
                <a data-mode-toggle href="?mode=letters" class="pill-link {% if mode == 'letters' %}is-active{% endif %}">Letters & Numbers</a>
            </div>

            {% if mode == 'letters' %}
            <div class="letters-grid" aria-label="Letters dictionary">
                {% for letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789' %}
                <form method="get" style="margin:0;">
                    <input type="hidden" name="mode" value="letters">
                    <input type="hidden" name="q" value="{{ letter }}">
                    <button type="submit">{{ letter }}</button>
                </form>
                {% endfor %}
            </div>
            {% else %}
            <form class="search-row" role="search" method="get">
                <input type="hidden" name="mode" value="{{ mode|default:'words' }}">
                <input type="text" name="q" value="{{ query|default:'' }}" placeholder="Search a word..." aria-label="Search word">
                <button type="submit">Search</button>
            </form>
            {% endif %}

            {% if query %}
            <header class="entry-header">
                <div class="entry-word">{{ entry.word|default:query }}</div>
                {% if entry.pronounce %}<div class="entry-pronounce">{{ entry.pronounce }}</div>{% endif %}
                {% if entry.partOfSpeech %}<span class="entry-pos">{{ entry.partOfSpeech }}</span>{% endif %}
            </header>

            <section class="section">
                <h3>ASL Video</h3>
                {% if asl_video %}
                    <div class="video-wrap">
                        <video id="asl-video" controls width="100%" style="max-width: 540px; border-radius: 10px; border: 1px solid var(--stroke); background: #000;">
                            <source src="{{ asl_video }}" type="video/mp4">
                            <source src="{{ asl_video }}" type="video/webm">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <p class="example">Source: SignASL (open API). If playback fails, <a href="{{ asl_video }}" target="_blank" rel="noopener">open the video</a>.</p>
                {% else %}
                    <p class="example">No ASL video found for “{{ query }}”.</p>
                {% endif %}
            </section>

            {% if mode != 'letters' and entry.definitions %}
            <section class="section">
                <h3>Definitions</h3>
                <ul class="definition-list">
                    {% for d in entry.definitions %}
                    <li class="definition-item">
                        {{ d.definition }}
                        {% if d.example %}<div class="example">“{{ d.example }}”</div>{% endif %}
                        {% if d.partOfSpeech and not entry.partOfSpeech %}<div class="example" aria-label="Part of speech">{{ d.partOfSpeech }}</div>{% endif %}
                    </li>
                    {% endfor %}
                </ul>
            </section>
            {% elif mode != 'letters' %}
            <p class="section">No definitions found for “{{ query }}”.</p>
            {% endif %}

            {% if mode != 'letters' and entry.synonyms %}
            <section class="section">
                <h3>Synonyms</h3>
                <div class="tags">
                    {% for s in entry.synonyms %}
                    <span class="tag">{{ s }}</span>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
            {% endif %}
        </div>
    </main>
    <script src="{% static 'js/dictionary.js' %}" defer></script>
    <nav class="bottom-nav" aria-label="Primary">
        <a href="{% url 'level' %}">Level Page</a>
        <a href="{% url 'practice' %}">Practice Page</a>
        <a href="{% url 'home' %}">Home Page</a>
        <a href="{% url 'dictionary' %}">Dictionary Page</a>
        <a href="{% url 'profile' %}">Profile</a>
    </nav>
</body>
</html>
